<div class="flex justify-center items-center mt-2">
    <div class="card card-border bg-base-100 w-full">
        <div class="card-body">
            <table class="table table-xs">
                <thead>
                    <tr>
                        <th>Sl</th>
                        <th>ID</th>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Phone</th>
                        <th>Company</th>
                        <th>Department</th>
                        <th>Role</th>
                        <th>Delete</th>
                    </tr>
                </thead>
                <tbody id="userTableBody">
                
                </tbody>
            </table>
        </div>
    </div>
</div>

<script type="module" src="~/js/UserAction.js"></script>

<script type="module">
    import { getAllUsers, deleteUser } from './js/UserAction.js';

    
    async function loadUsers() {
        const response = await getAllUsers(); 
        const users = response.data;

        console.log(users);

        const tableBody = document.getElementById("userTableBody");

        
        tableBody.innerHTML = "";

        if (users && users.length > 0) {
            users.forEach((user, index) => {
                const row = document.createElement("tr");
                row.innerHTML = `
                        <td>${index + 1}</td>
                        <td>${user.id}</td>
                        <td>${user.name}</td>
                        <td>${user.email}</td>
                        <td>${user.phone}</td>
                        <td>${user.company}</td>
                        <td>${user.department}</td>
                        <td>${user.role}</td>
                        <td><button class="delete-btn bg-red-500 text-white p-1 rounded-md">Delete</button></td>
                    `;

               
                const deleteButton = row.querySelector(".delete-btn");
                deleteButton.addEventListener("click", () => deleteUserById(user.id));

                tableBody.appendChild(row);
            });
        } else {
            
            const row = document.createElement("tr");
            row.innerHTML = `<td colspan="9" class="text-center">No users found.</td>`;
            tableBody.appendChild(row);
        }
    }

  
    async function deleteUserById(userId) {
        const result = await deleteUser(userId);
        if (result) {
            alert("User deleted successfully!");
            loadUsers();
        }
    }

    loadUsers(); 

</script>